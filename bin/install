#!/bin/sh

# Install script for a fresh OS X install.
# More meant for copy-pasting rather than just running so far.

git clone https://github.com/tadassce/dotfiles.git ~/Dot

# - Install 1P and XCode from the MAS

xcode-select --install

# Install Homebrew
ruby -e "$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/master/install)"

brew install vim git zsh tmux chruby ruby-install ctags \
  reattach-to-user-namespace the_silver_searcher mysql redis mongodb wget \
  heroku-toolbelt

# Homebrew Cask
brew install caskroom/cask/brew-cask
export HOMEBREW_CASK_OPTS="--appdir=/Applications"
brew cask install nvalt dropbox seil karabiner alfred
brew cask alfred link

# Set the default shell (and in Users' prefs)
chsh -s /usr/local/bin/zsh

# Aliases
ln -s ~/Dot/agignore         ~/.agignore
ln -s ~/Dot/aliases          ~/.aliases
ln -s ~/Dot/completions      ~/.completions
ln -s ~/Dot/gemrc            ~/.gemrc
ln -s ~/Dot/git_template     ~/.git_template
ln -s ~/Dot/gitconfig        ~/.gitconfig
ln -s ~/Dot/gitignore_global ~/.gitignore_global
ln -s ~/Dot/gvimrc           ~/.gvimrc
ln -s ~/Dot/inputrc          ~/.inputrc
ln -s ~/Dot/prompt           ~/.prompt
ln -s ~/Dot/pryrc            ~/.pryrc
ln -s ~/Dot/rspec            ~/.rspec
ln -s ~/Dot/tmux.conf        ~/.tmux.conf
ln -s ~/Dot/tmux             ~/.tmux
ln -s ~/Dot/vim              ~/.vim
ln -s ~/Dot/vimrc            ~/.vimrc
ln -s ~/Dot/vimrc_mini       ~/.vimrc_mini
ln -s ~/Dot/zsh              ~/.zsh
ln -s ~/Dot/zshrc            ~/.zshrc

# Vim - Install Pathogen
mkdir -p ~/.vim/autoload ~/.vim/bundle && \
  curl -LSso ~/.vim/autoload/pathogen.vim https://tpo.pe/pathogen.vim

vim_plugins=(
  AndrewRadev/splitjoin.vim
  AndrewRadev/switch.vim
  bling/vim-airline
  derekwyatt/vim-scala
  godlygeek/tabular
  jpalardy/vim-slime
  kchmck/vim-coffee-script
  kien/ctrlp.vim
  reedes/vim-colors-pencil
  rking/ag.vim
  scrooloose/nerdtree
  scrooloose/syntastic
  sunaku/vim-ruby-minitest
  szw/vim-ctrlspace
  thoughtbot/vim-rspec
  tmhedberg/matchit
  tpope/vim-commentary
  tpope/vim-dispatch
  tpope/vim-endwise
  tpope/vim-fugitive
  tpope/vim-jdaddy
  tpope/vim-obsession
  tpope/vim-projectionist
  tpope/vim-rails
  tpope/vim-rake
  tpope/vim-surround
  tpope/vim-unimpaired
  vim-ruby/vim-ruby
)
cd ~/.vim/bundle
for plugin in $vim_plugins; do
  git clone https://github.com/$plugin.git
done

# Tmux Plugin Manager
git clone https://github.com/tmux-plugins/tpm ~/.tmux/plugins/tpm

# Set some OS X defaults
defaults write com.apple.Dock autohide-delay -float 0
killall Dock

ruby-install ruby 2.1.4

# Some must-have gems
gem install pry pry-doc reek rubocop ruby-lint

# Fix zsh env
sudo mv /etc/zshenv /etc/zprofile

# Bring back brew-services
brew tap gapple/services

# Install Pow
curl get.pow.cx | sh

# Some useful Quick Look plugins
brew cask install qlcolorcode qlstephen qlmarkdown quicklook-json \
  quicklook-csv qlimagesize
